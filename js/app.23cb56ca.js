(function(e){function t(t){for(var a,c,s=t[0],o=t[1],u=t[2],l=0,g=[];l<s.length;l++)c=s[l],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&g.push(r[c][0]),r[c]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);m&&m(t);while(g.length)g.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,s=1;s<n.length;s++){var o=n[s];0!==r[o]&&(a=!1)}a&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},r={app:0},i=[];function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/winwin/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],o=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var m=o;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"1e2e":function(e,t,n){"use strict";var a=n("dc28"),r=n.n(a);r.a},2541:function(e,t,n){"use strict";var a=n("eeac"),r=n.n(a);r.a},3763:function(e,t,n){"use strict";var a=n("8750"),r=n.n(a);r.a},"49b5":function(e,t,n){"use strict";var a=n("f5a4"),r=n.n(a);r.a},"510b":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},i=[],c=(n("5c0b"),n("2877")),s={},o=Object(c["a"])(s,r,i,!1,null,null,null),u=o.exports,m=n("8c4f"),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"main"},[n("div",{staticClass:"main__header"},[n("Header")],1),n("div",{staticClass:"main__content"},[n("router-view")],1)])},g=[],d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header"},[n("div",{staticClass:"header-logo"},[n("router-link",{staticClass:"header-logo__link",attrs:{to:{name:"ImagesPage"}}},[e._v(" Wi"),n("span",{staticClass:"header-logo_size"},[e._v("n")]),e._v("Wi"),n("span",{staticClass:"header-logo_size"},[e._v("n")])])],1)])},p=[],f={name:"Header"},b=f,h=(n("b5d0"),Object(c["a"])(b,d,p,!1,null,"3ae2f863",null)),v=h.exports,_={name:"MainLayout",components:{Header:v}},I=_,w=(n("49b5"),Object(c["a"])(I,l,g,!1,null,"7d1be258",null)),O=w.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"images-pages"},[e.isClickOnInputFile?n("div",{staticClass:"images-pages__menu menu-actions"},[n("Button",{attrs:{name_button:"Новое изображение"},on:{up:e.chooseImage}}),n("div",{staticClass:"input-file"},[n("input",{ref:"inputFile",attrs:{type:"file"}})])],1):n("div",{staticClass:"images-pages__menu menu-actions"},[n("Button",{attrs:{name_button:"Загрузить"},on:{up:e.setImage}}),n("Button",{attrs:{name_button:"Не загружать"},on:{up:e.getBack}})],1),e.getImages.length?n("draggable",{staticClass:"images-pages__items images-container",model:{value:e.newSequenceImg,callback:function(t){e.newSequenceImg=t},expression:"newSequenceImg"}},e._l(e.getImages,(function(e){return n("div",{key:e.imageId,staticClass:"images-container__item"},[n("router-link",{attrs:{to:{name:"ImagePage",params:{id:e.imageId}}}},[n("ImageContainer",{attrs:{imageUrl:e.imageUrl}})],1)],1)})),0):n("div",{staticClass:"images-pages__info"},[e._v(" Фотографий нет ")]),e.isFetching?n("Preloader"):e._e()],1)},j=[],C=(n("96cf"),n("1da1")),k=n("5530"),B=n("2f62"),F=n("310e"),R=n.n(F),y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"image-container"},[n("img",{staticClass:"image-container__item",attrs:{src:e.imageUrl,alt:"фото"}})])},D=[],E={name:"ImageContainer",props:{imageUrl:String}},P=E,U=(n("7e26"),Object(c["a"])(P,y,D,!1,null,"ac400550",null)),S=U.exports,$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"button-container"},[n("button",{staticClass:"button-container__btn",on:{click:e.handler}},[e._v(e._s(e.name_button))])])},A=[],M={name:"Button",props:{name_button:String},methods:{handler:function(){this.$emit("up")}}},L=M,T=(n("3763"),Object(c["a"])(L,$,A,!1,null,"35c9c346",null)),q=T.exports,z=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},G=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"lds-container"},[n("div",{staticClass:"lds-container__item"},[n("div",{staticClass:"lds-spinner"},[n("div"),n("div"),n("div"),n("div"),n("div"),n("div"),n("div"),n("div"),n("div"),n("div"),n("div"),n("div")])])])}],H={name:"Preloader"},K=H,W=(n("e47f"),Object(c["a"])(K,z,G,!1,null,"13a08e64",null)),J=W.exports,V={name:"ImagesPage",components:{ImageContainer:S,Button:q,Preloader:J,draggable:R.a},data:function(){return{isClickOnInputFile:!0,isFetching:!1}},methods:Object(k["a"])(Object(k["a"])({},Object(B["b"])(["getImagesFromDB","setImageIntoDB","updateOrderImagesDB"])),{},{chooseImage:function(){this.inputFileData.click(),this.isClickOnInputFile=!1},setImage:function(){var e=this;return Object(C["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isFetching=!0,n=e.inputFileData.files[0],t.next=4,e.setImageIntoDB(n);case 4:e.isFetching=!1,e.isClickOnInputFile=!0;case 6:case"end":return t.stop()}}),t)})))()},getBack:function(){this.isClickOnInputFile=!0}}),computed:Object(k["a"])(Object(k["a"])({},Object(B["c"])(["getImages"])),{},{newSequenceImg:{get:function(){return this.getImages},set:function(e){var t=this;return Object(C["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.isFetching=!0,n.next=3,t.updateOrderImagesDB(e);case 3:t.isFetching=!1;case 4:case"end":return n.stop()}}),n)})))()}}}),mounted:function(){var e=this;return Object(C["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.inputFileData=e.$refs.inputFile,e.isFetching=!0,t.next=4,e.getImagesFromDB();case 4:e.isFetching=!1;case 5:case"end":return t.stop()}}),t)})))()}},Y=V,N=(n("782c"),Object(c["a"])(Y,x,j,!1,null,"d2374c7e",null)),Q=N.exports,X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"image-container"},[n("div",{staticClass:"image-container__item"},[n("div",{staticClass:"image"},[n("img",{staticClass:"image__img",attrs:{src:e.imageUrl,alt:"фото"}})])]),n("div",{staticClass:"image-container__menu button-container"},[n("Button",{staticClass:"button-container__item",attrs:{name_button:"Редактировать"},on:{up:e.onEditImage}}),n("Button",{staticClass:"button-container__item",attrs:{name_button:"Удалить"},on:{up:e.onDeleteImage}}),n("Button",{staticClass:"button-container__item",attrs:{name_button:"Скачать"},on:{up:e.onDownloadImage}}),n("Button",{staticClass:"button-container__item",attrs:{name_button:"Назад"},on:{up:e.getBack}})],1),e.isFetching?n("Preloader"):e._e()],1)},Z=[],ee=(n("7db0"),n("ac1f"),n("5319"),{name:"ImagePage",components:{Preloader:J,Button:q},data:function(){return{imageUrl:null,isFetching:!1,imageId:null}},methods:Object(k["a"])(Object(k["a"])({},Object(B["b"])(["deleteImageFromDB","downloadImage"])),{},{onDeleteImage:function(){var e=this;return Object(C["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isFetching=!0,t.next=3,e.deleteImageFromDB(e.imageId);case 3:e.isFetching=!1,e.getBack();case 5:case"end":return t.stop()}}),t)})))()},getBack:function(){this.$router.replace({name:"ImagesPage"})},onEditImage:function(){this.$router.replace({name:"EditImagePage",params:{id:this.imageId}})},onDownloadImage:function(){var e=this;return Object(C["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isFetching=!0,t.next=3,e.downloadImage(e.imageUrl);case 3:e.isFetching=!1;case 4:case"end":return t.stop()}}),t)})))()}}),computed:Object(k["a"])({},Object(B["c"])(["getImages"])),mounted:function(){var e=this,t=this.getImages.find((function(t){return t.imageId===e.$route.params.id}));this.imageUrl=t.imageUrl,this.imageId=t.imageId}}),te=ee,ne=(n("1e2e"),Object(c["a"])(te,X,Z,!1,null,null,null)),ae=ne.exports,re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"image-container"},[n("div",{staticClass:"image-container__cropper"},[n("vue-cropper",{ref:"cropper",attrs:{containerStyle:{width:"100%",height:"100%"}}})],1),n("div",{staticClass:"image-container__menu button-container"},[n("Button",{staticClass:"button-container__item",attrs:{name_button:"Сохранить"},on:{up:e.onSaveImage}}),n("Button",{staticClass:"button-container__item",attrs:{name_button:"Сброс"},on:{up:e.onResetImage}}),n("Button",{staticClass:"button-container__item",attrs:{name_button:"Назад"},on:{up:e.getBack}})],1),e.isFetching?n("Preloader"):e._e()],1)},ie=[],ce=n("95c3"),se=n.n(ce),oe=(n("6107"),{name:"EditImagePage",components:{Button:q,Preloader:J,VueCropper:se.a},data:function(){return{imageUrl:null,imageId:null,cropImg:null,isFetching:!1}},methods:Object(k["a"])(Object(k["a"])({},Object(B["b"])(["updateImageAfterEdit"])),{},{onSaveImage:function(){var e=this;this.$refs.cropper.getCroppedCanvas().toBlob(function(){var t=Object(C["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isFetching=!0,t.next=3,e.updateImageAfterEdit({file:n,imageUrl:e.imageUrl,imageId:e.imageId});case 3:e.isFetching=!1,e.getBack();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},onResetImage:function(){this.$refs.cropper.reset()},getBack:function(){this.$router.replace({name:"ImagePage",params:{id:this.imageId}})}}),computed:Object(k["a"])({},Object(B["c"])(["getImages"])),mounted:function(){var e=this,t=this.getImages.find((function(t){return t.imageId===e.$route.params.id}));this.imageUrl=t.imageUrl,this.imageId=t.imageId,this.$refs.cropper.replace(this.imageUrl)}}),ue=oe,me=(n("2541"),Object(c["a"])(ue,re,ie,!1,null,"37cd6c92",null)),le=me.exports;a["a"].use(m["a"]);var ge=[{path:"/",component:O,children:[{path:"",name:"ImagesPage",component:Q},{path:":id",name:"ImagePage",component:ae},{path:":id/edit",name:"EditImagePage",component:le}]}],de=new m["a"]({mode:"history",base:"/winwin/",routes:ge}),pe=de,fe=(n("4160"),n("b0c0"),n("d3b7"),n("07ac"),n("3ca3"),n("159b"),n("ddb0"),n("2b3d"),n("ade3")),be=n("8468"),he=n("b85c"),ve=n("59ca"),_e=n.n(ve);a["a"].use(B["a"]);var Ie=new B["a"].Store({state:{images:[]},mutations:{SET_IMAGES:function(e,t){e.images=t}},actions:{getImagesFromDB:function(e){return Object(C["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,t.prev=1,t.next=4,_e.a.database().ref("images");case 4:a=t.sent,a.once("value",(function(e){var t=e.val();if(t){var a=Object.values(t);n("SET_IMAGES",a)}else n("SET_IMAGES",[])})),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()},updateOrderImagesDB:function(e,t){return Object(C["a"])(regeneratorRuntime.mark((function n(){var a,r,i,c,s,o,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a=e.state,r=e.dispatch,n.prev=1,i=Object(he["a"])(a.images),n.prev=3,i.s();case 5:if((c=i.n()).done){n.next=11;break}return s=c.value,n.next=9,_e.a.database().ref("images/"+s.imageId).remove();case 9:n.next=5;break;case 11:n.next=16;break;case 13:n.prev=13,n.t0=n["catch"](3),i.e(n.t0);case 16:return n.prev=16,i.f(),n.finish(16);case 19:return o={},u=0,t.forEach((function(e){u++,o["images/".concat(u)]={imageId:u,imageUrl:e.imageUrl}})),n.next=24,_e.a.database().ref().update(o);case 24:return n.next=26,r("getImagesFromDB");case 26:n.next=31;break;case 28:n.prev=28,n.t1=n["catch"](1),console.log(n.t1);case 31:case"end":return n.stop()}}),n,null,[[1,28],[3,13,16,19]])})))()},updateImageAfterEdit:function(e,t){return Object(C["a"])(regeneratorRuntime.mark((function n(){var a,r,i,c,s,o,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return Object(be["a"])(e),a=t.file,r=t.imageUrl,i=t.imageId,n.prev=2,n.next=5,_e.a.storage().refFromURL(r);case 5:return c=n.sent,n.next=8,c.put(a);case 8:return s=n.sent,n.next=11,s.ref.getDownloadURL();case 11:return o=n.sent,u=Object(fe["a"])({},"imagesData/".concat(i),{imageId:i,imageUrl:o}),n.next=15,_e.a.database().ref().update(u);case 15:n.next=20;break;case 17:n.prev=17,n.t0=n["catch"](2),console.log(n.t0);case 20:case"end":return n.stop()}}),n,null,[[2,17]])})))()},setImageIntoDB:function(e,t){return Object(C["a"])(regeneratorRuntime.mark((function n(){var a,r,i,c,s,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.dispatch,n.prev=1,r=_e.a.storage().ref(),i={contentType:t.type},n.next=6,r.child(t.name).put(t,i);case 6:return c=n.sent,n.next=9,c.ref.getDownloadURL();case 9:return s=n.sent,o=Date.now(),n.next=13,_e.a.database().ref("images/"+o).set({imageId:o,imageUrl:s});case 13:return n.next=15,a("getImagesFromDB");case 15:n.next=20;break;case 17:n.prev=17,n.t0=n["catch"](1),console.log(n.t0);case 20:case"end":return n.stop()}}),n,null,[[1,17]])})))()},deleteImageFromDB:function(e,t){return Object(C["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.dispatch,n.prev=1,n.next=4,_e.a.database().ref("images/"+t).remove();case 4:a("getImagesFromDB"),n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](1),console.log(n.t0);case 10:case"end":return n.stop()}}),n,null,[[1,7]])})))()},downloadImage:function(e,t){return Object(C["a"])(regeneratorRuntime.mark((function n(){var a,r,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return Object(be["a"])(e),a=document.createElement("a"),a.download="image.jpg",n.next=5,fetch(t);case 5:return r=n.sent,n.next=8,r.blob();case 8:i=n.sent,a.target="_blank",a.href=URL.createObjectURL(i),a.click();case 12:case"end":return n.stop()}}),n)})))()}},getters:{getImages:function(e){return e.images}},modules:{}});n("66ce"),n("588e");_e.a.initializeApp({apiKey:"AIzaSyCoYXrWg_QdNRoiFtz-pAP0qrhZ6VKKYk0",authDomain:"winwin-bc12b.firebaseapp.com",databaseURL:"https://winwin-bc12b.firebaseio.com",projectId:"winwin-bc12b",storageBucket:"winwin-bc12b.appspot.com",messagingSenderId:"765837126346",appId:"1:765837126346:web:38c387729e3154c24aa233"}),a["a"].config.productionTip=!1,new a["a"]({router:pe,store:Ie,render:function(e){return e(u)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var a=n("9c0c"),r=n.n(a);r.a},"782c":function(e,t,n){"use strict";var a=n("d860"),r=n.n(a);r.a},"7e26":function(e,t,n){"use strict";var a=n("e830"),r=n.n(a);r.a},8750:function(e,t,n){},"9c0c":function(e,t,n){},b5d0:function(e,t,n){"use strict";var a=n("ef71"),r=n.n(a);r.a},d860:function(e,t,n){},dc28:function(e,t,n){},e47f:function(e,t,n){"use strict";var a=n("510b"),r=n.n(a);r.a},e830:function(e,t,n){},eeac:function(e,t,n){},ef71:function(e,t,n){},f5a4:function(e,t,n){}});
//# sourceMappingURL=app.23cb56ca.js.map